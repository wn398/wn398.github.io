
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Maven | 自由之翼</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Tim Wang">
    
    <meta name="description" content="Maven基本使用：mvn help:system 打印出所有Java系统属性和环境变量，下载maven-help-plugin文件
Maven最主要的命令：mvn clean compile,mvn clean test,mvn clean package,mvn clean install.执行">
    
    
    <meta name="description" content="Maven基本使用：mvn help:system 打印出所有Java系统属性和环境变量，下载maven-help-plugin文件
Maven最主要的命令：mvn clean compile,mvn clean test,mvn clean package,mvn clean install.执行test之前会先执行compile的，执行package之前会先执行test，install（把ja">
<meta property="og:type" content="article">
<meta property="og:title" content="Maven">
<meta property="og:url" content="http://wn398.github.io/2014/04/08/Maven/index.html">
<meta property="og:site_name" content="自由之翼">
<meta property="og:description" content="Maven基本使用：mvn help:system 打印出所有Java系统属性和环境变量，下载maven-help-plugin文件
Maven最主要的命令：mvn clean compile,mvn clean test,mvn clean package,mvn clean install.执行test之前会先执行compile的，执行package之前会先执行test，install（把ja">
<meta property="og:updated_time" content="2015-03-26T05:57:47.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Maven">
<meta name="twitter:description" content="Maven基本使用：mvn help:system 打印出所有Java系统属性和环境变量，下载maven-help-plugin文件
Maven最主要的命令：mvn clean compile,mvn clean test,mvn clean package,mvn clean install.执行test之前会先执行compile的，执行package之前会先执行test，install（把ja">
<meta name="twitter:creator" content="@wn1698">
<link rel="publisher" href="108412565662276580000">

    
    <link rel="alternative" href="/atom.xml" title="自由之翼" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="自由之翼" title="自由之翼"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="自由之翼">自由之翼</a></h1>
				<h2 class="blog-motto">The perfect day Going to bed with a dream ,waking up with a purpose</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
 					
						<form class="search" action="http://zhannei.baidu.com/cse/search" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= null ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/Maven/" title="Maven" itemprop="url">Maven</a>
  </h1>
  <p class="article-author">By
       
		<a href="https://plus.google.com/108412565662276580000?rel=author" title="Tim Wang" target="_blank" itemprop="author">Tim Wang</a>
		
  <p class="article-time">
    <time datetime="2014-04-08T02:55:27.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven基本使用："><span class="toc-number">1.</span> <span class="toc-text">Maven基本使用：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#maven坐标"><span class="toc-number">1.1.</span> <span class="toc-text">maven坐标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven依赖"><span class="toc-number">1.2.</span> <span class="toc-text">Maven依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven仓库管理："><span class="toc-number">1.3.</span> <span class="toc-text">Maven仓库管理：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven生命周期："><span class="toc-number">1.4.</span> <span class="toc-text">Maven生命周期：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Clean生命周期"><span class="toc-number">1.4.1.</span> <span class="toc-text">Clean生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defaut生命周期"><span class="toc-number">1.4.2.</span> <span class="toc-text">defaut生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#site生命周期"><span class="toc-number">1.4.3.</span> <span class="toc-text">site生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命令行与生命周期"><span class="toc-number">1.4.4.</span> <span class="toc-text">命令行与生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生命周期与插件绑定"><span class="toc-number">1.4.5.</span> <span class="toc-text">生命周期与插件绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven的聚合与继承："><span class="toc-number">1.5.</span> <span class="toc-text">Maven的聚合与继承：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用Nexus创建私服"><span class="toc-number">1.6.</span> <span class="toc-text">使用Nexus创建私服</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven执行单个测试类"><span class="toc-number">1.7.</span> <span class="toc-text">Maven执行单个测试类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven快速开发web项目"><span class="toc-number">1.8.</span> <span class="toc-text">Maven快速开发web项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven的持续集成"><span class="toc-number">1.9.</span> <span class="toc-text">Maven的持续集成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven与自动化部署"><span class="toc-number">1.10.</span> <span class="toc-text">Maven与自动化部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#版本管理"><span class="toc-number">1.11.</span> <span class="toc-text">版本管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven与项目release"><span class="toc-number">1.12.</span> <span class="toc-text">Maven与项目release</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#利用Maven自动化创建分支："><span class="toc-number">1.13.</span> <span class="toc-text">利用Maven自动化创建分支：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven与签名："><span class="toc-number">1.14.</span> <span class="toc-text">Maven与签名：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven灵活的构建："><span class="toc-number">2.</span> <span class="toc-text">Maven灵活的构建：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven属性"><span class="toc-number">2.1.</span> <span class="toc-text">Maven属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#资源过滤"><span class="toc-number">2.2.</span> <span class="toc-text">资源过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven_Profile"><span class="toc-number">2.3.</span> <span class="toc-text">Maven Profile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Profile激活"><span class="toc-number">2.3.1.</span> <span class="toc-text">Profile激活</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#profile的种类"><span class="toc-number">2.3.2.</span> <span class="toc-text">profile的种类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web资源过滤、"><span class="toc-number">2.4.</span> <span class="toc-text">web资源过滤、</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven与自动化站点生成"><span class="toc-number">3.</span> <span class="toc-text">Maven与自动化站点生成</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven与代码检查及代码分析"><span class="toc-number">4.</span> <span class="toc-text">Maven与代码检查及代码分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#编写Maven插件的一般步骤"><span class="toc-number">5.</span> <span class="toc-text">编写Maven插件的一般步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#常用archetype介绍"><span class="toc-number">6.</span> <span class="toc-text">常用archetype介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven常用插件列表："><span class="toc-number">7.</span> <span class="toc-text">Maven常用插件列表：</span></a></li></ol>
		
		</div>
		
		<h1 id="Maven基本使用：">Maven基本使用：</h1><p><code>mvn help:system</code> 打印出所有Java系统属性和环境变量，下载maven-help-plugin文件</p>
<p>Maven最主要的命令：<code>mvn clean compile</code>,<code>mvn clean test</code>,<code>mvn clean package</code>,<code>mvn clean install</code>.执行test之前会先执行compile的，执行package之前会先执行test，install（把jar包安装到仓库中供所有人使用） 之前会执行package,可以在任何一个Maven项目中执行这些命令。</p>
<p>可以直接运行<code>mvn archetype:generate</code>去生成项目基本骨架。会有很多<code>Archetype</code>供选择，包括著名的Appfuse项目的Archetype,JPA项目的Archetype等。每一个Archetype前面都会对应有一个编号，同时命令行会提示一个默认的编号，其对应的Archetype为maven-archetype-quickstart,直接回车以选择该Archetype,紧接着Maven会提示输入要创建项目的groupId,artifacetId,version以及包名package</p>
<h2 id="maven坐标">maven坐标</h2><p><code>groupId</code>:　　当前Maven项目隶属的实际项目，可以是域名反向</p>
<p><code>artifacId</code>：　　该元素定义实际项目中的一个Maven项目（模块），推荐的做法是使用实际项目名作为它的前缀</p>
<p><code>version</code>：　　当前版本</p>
<p><code>packaging</code>：定义Maven项目的打包方式。首先，打包方式通常与所生成构件的文件扩展名对应。jar包和war包会使用不同的命令，当不定义packaging的时候，默认使用jar</p>
<p><code>classifier</code>：　　帮助定义构建输出的一些附属构件。附属构件与主构件对应</p>
<p><code>dependency</code>　　下面的scope用来定义依赖的范围。当为test的时候，该依赖只会被加入到测试代码的测试框架，只有在测试的时候才需要，对于项目主代码，该依赖是不没有任何作用的</p>
<h2 id="Maven依赖">Maven依赖</h2><p>　　可运行<code>mvn dependency:list</code>　　查看当前项目的已解析依赖<br>　　可以运行<code>mvn dependency:tree</code>　　查看当前项目的依赖树<br>　　使用<code>mvn dependency:analyze</code>　　工具可以帮助分析当前项目的依赖</p>
<pre><code><span class="tag">&lt;<span class="title">project</span>&gt;</span>
 <span class="tag">&lt;<span class="title">dependencies</span>&gt;</span>
  <span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
   <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>..<span class="tag">&lt;/<span class="title">groudId</span>&gt;</span>
   <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>..<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
   <span class="tag">&lt;<span class="title">version</span>&gt;</span>..<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
   <span class="tag">&lt;<span class="title">type</span>&gt;</span>..<span class="tag">&lt;/<span class="title">type</span>&gt;</span><span class="comment">&lt;!--依赖的类型，对应于项目坐标定义的packaging,大部分情况下，该元素不必声明，其默认值为jar--&gt;</span>
   <span class="tag">&lt;<span class="title">sope</span>&gt;</span>..<span class="tag">&lt;/<span class="title">scope</span>&gt;</span><span class="comment">&lt;!--依赖的范围 1.compile编译依赖范围。如果没有指定就会默认使用该依赖范围。使用此依赖范围的Maven依赖，对于编译，测试，运行三种classpath都有效
                                  2.test 测试依赖范围。使用此依赖范围的Maven依赖，只对于测试classpath有效，典型例子是Junit
             3.provided 已提供依赖范围。使用此依赖范围的Maven依赖，对于编译和测试classpath有效，但在运行时无效。典型的例子是serlet-api,编译和测试项目的时候需要该依赖，但在运行项目的时候，由于容器已提供就不需要Maven重复地引入一遍-
             4.runtime 运行时依赖范围。使用此依赖范围的Maven依赖，对于测试和运行classpath有效，但在编译主代码时无效。典型的例子是JDBC驱动实现，项目主代码的编译只需要JDK提供的JDBC接口，只有在执行测试或者运行项目的时候才需要实现上述接口的具体JDBC驱动
             5.system系统依赖范围，该依赖与三种classpath关系，和provided依赖范围完全一致。但是，使用system范围的依赖时必须通过systemPath元素显式地指定依赖文件的路径。由于此类依赖不是通过Maven仓库解析的，而且往往与本机系统绑定，可能造成构建的不可移植性。
             6.import 导入依赖范围，该依赖范围不会对三种classpath产生实际影响-&gt;
   &lt;optional&gt;..&lt;/optional&gt;&lt;!--标记依赖是否可选，可选依赖不会被传递--&gt;</span>

   <span class="tag">&lt;<span class="title">exclusions</span>&gt;</span><span class="comment">&lt;!--用来排除传递性依赖--&gt;</span>
    <span class="tag">&lt;<span class="title">exclusion</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">exclusion</span>&gt;</span>
   <span class="tag">&lt;/<span class="title">exclusions</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span>
<span class="tag">&lt;/<span class="title">project</span>&gt;</span>
</code></pre><h2 id="Maven仓库管理：">Maven仓库管理：</h2><p><a href="http://repository.sonatype.org/" target="_blank" rel="external">http://repository.sonatype.org/</a></p>
<p>Nexus是当前最流行的开源Maven仓库管理软件，它提供了<em>关键字搜索，`类名搜索，坐标搜索，校验和搜索</em>等功能。</p>
<h2 id="Maven生命周期：">Maven生命周期：</h2><p>Maven拥有三套相互独立的生命周期，它们分别是<code>clean</code>,<code>default</code>和<code>site</code>。clean生命周期的目的是清理项目，default生命周期的目的是构建项目，而site生命周期的目的是建立项目站点。</p>
<h3 id="Clean生命周期">Clean生命周期</h3><ol>
<li><p><code>pre-clean</code>执行一些清理前需要完成的工作</p>
</li>
<li><p><code>clean</code>清理上一次构建生成的文件</p>
</li>
<li><p><code>post-clean</code>执行一些清理后需要完成的工作</p>
</li>
</ol>
<h3 id="defaut生命周期">defaut生命周期</h3><p>default生命周期定义了真正构建时所需要执行的所有步骤，它是所有生命周期中最核心的部分</p>
<ol>
<li><p><code>validate</code></p>
</li>
<li><p><code>initialize</code></p>
</li>
<li><p><code>generate-sources</code></p>
</li>
<li><p><code>process-sources</code>   处理项目主资源文件。一般来说，是对src/main/resources目录的内容进行变更替换等工作后，复制到项目输出的主classpath目录中</p>
</li>
<li><p><code>generate-resources</code></p>
</li>
<li><p><code>process-resoures</code></p>
</li>
<li><p><code>compile</code>       编译项目的主源代码</p>
</li>
<li><p><code>process-classes</code></p>
</li>
<li><p><code>generate-test-sources</code></p>
</li>
<li><p><code>process-test-sources</code>          处理项目测试资源文件，一般来说是对src/test/resources目录的内容进行变量替换等工作后，复制到项目输出的测试classpath目录中</p>
</li>
<li><p><code>generate-test-resoures</code></p>
</li>
<li><p><code>process-test-resoures</code></p>
</li>
<li><p><code>test-compile</code>             编译项目的中测试代码</p>
</li>
<li><p><code>process-test-classes</code></p>
</li>
<li><p><code>test</code>             使用单元测试框架运行测试，测试代码不会被打包或部署</p>
</li>
<li><p><code>prepare-package</code></p>
</li>
<li><p><code>package</code>           接受编译好的代码，打包成可发布的格式</p>
</li>
<li><p><code>pre-integration-test</code></p>
</li>
<li><p><code>integration-test</code></p>
</li>
<li><p><code>post-integration-test</code></p>
</li>
<li><p><code>verify</code></p>
</li>
<li><p><code>install</code>          将包安装到Maven本地仓库，供本地其他Maven项目使用</p>
</li>
<li><p><code>deploy</code>            将最终的包复制到远程仓库，供其他开发人员和Maven项目使用</p>
</li>
</ol>
<h3 id="site生命周期">site生命周期</h3><ol>
<li><p><code>pre-site</code>执行一些在生成项目站点之前需要完成的工作</p>
</li>
<li><p><code>site</code> 生成项目站点文档</p>
</li>
<li><p><code>post-site</code> 执行一些在生成项目站点之后需要完成的工作</p>
</li>
<li><p><code>site-deploy</code>将生成的项目站点发布到服务器上</p>
</li>
</ol>
<h3 id="命令行与生命周期">命令行与生命周期</h3><p><code>mvn clean</code>   调用clean生命周期的clean阶段</p>
<p><code>mvn test</code>   调用defaut生命周期的test阶段</p>
<p><code>mvn clean install</code>   调用clean生命周期的clean阶段和defaut生命周期的install阶段</p>
<p><code>mvn clean deploy site-deploy</code>  调用了clean生命周期的clean阶段，default生命周期的deploy阶段，以及site生命周期的site-deploy阶段</p>
<h3 id="生命周期与插件绑定">生命周期与插件绑定</h3><p>除了内置绑定外，用户还能够自己选择将某个目标绑定到生命周期的某个阶段上，这种自定义绑定方式能让Maven项目在构建过程中执行更多更富有特色的任务。<br>一个例子是创建项目的jar包，内置的插件绑定关系中并没有涉及这一任务。</p>
<pre><code><span class="comment">&lt;!--内置绑定源码--&gt;</span>
 <span class="tag">&lt;<span class="title">build</span>&gt;</span>
  <span class="tag">&lt;<span class="title">plugins</span>&gt;</span>
   <span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifacetId</span>&gt;</span>maven-source-plugin<span class="tag">&lt;/<span class="title">artifacetId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.1.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">executions</span>&gt;</span>
     <span class="tag">&lt;<span class="title">id</span>&gt;</span>attach-soures<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
     <span class="tag">&lt;<span class="title">phase</span>&gt;</span>verify<span class="tag">&lt;/<span class="title">phase</span>&gt;</span>
     <span class="tag">&lt;<span class="title">goals</span>&gt;</span>
     <span class="tag">&lt;<span class="title">goal</span>&gt;</span>jar-no-fork<span class="tag">&lt;/<span class="title">goal</span>&gt;</span>
     <span class="tag">&lt;/<span class="title">goals</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">executions</span>&gt;</span>
   <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">plugins</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">build</span>&gt;</span>
</code></pre><h2 id="Maven的聚合与继承：">Maven的聚合与继承：</h2><p>Maven的聚合特性能够把项目的各个模块聚合在一起构建，而Maven的继承特性则能帮助抽取各模块相同的依赖和插件等配置，在简化pom的同时，还能促进各个模块配置的一致性。</p>
<p>与聚合模块一样，作为父模块的POM，其打包类型也必须为pom<br>哪些POM元素可以被继承：</p>
<pre><code>groupId 项目组ID，项目坐标的核心元素
version 项目版本，项目坐标的核心元素
description 项目的描述信息
<span class="label">organization:</span>项目的组织信息
inceptionYear 项目的创始年份
url 项目的URL地址
developers 项目的开发者
contributions项目的贡献者信息
distributionManagement：项目的部署配置
issueManagement：项目的缺陷跟踪系统信息
ciManagement项目的持续集成系统系统信息
scm 项目的版本控制系统信息
<span class="label">maillingLists:</span>项目的邮件列表信息
<span class="label">properties:</span>自定义Maven属性
<span class="label">dependencies:</span>项目的依赖配置
<span class="label">dependencyManagement:</span>项目的依赖管理配置
repositories项目的仓库配置
build 包括项目的源码目录配置，输出目录配置，插件配置，插件管理配置等
reporting：包括项目的报告输出目录，报告插件配置等
</code></pre><p>Maven提供的dependencyManagement元素既能让子模块继承到父模块的依赖配置，又能保证子模块依赖使用的灵活性。在dependencyManagement元素下的依赖声明不会引入实际的依赖</p>
<h2 id="使用Nexus创建私服">使用Nexus创建私服</h2><p>私服不是Maven的核心概念，它仅仅是一种衍生出来的特殊的Maven仓库。通过建立自己的私服可以降低中央仓库负荷，节省外网带宽，加速Maven构建，自己部署构件等，从而高效地使用Maven</p>
<h2 id="Maven执行单个测试类">Maven执行单个测试类</h2><p>Maven-surefire-plugin提供了一个test参数让Maven用户能够在命令行指定要运行的测试用例。如只想运行<code>accout-captcha</code>的<code>RandomGeneratioTest</code><br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$mvn test -Dtest=RandomGeneratorTest</div></pre></td></tr></table></figure></p>
<p>这里test参数的值是测试用例的类名，参数还支持*和，来指定多个用例</p>
<h2 id="Maven快速开发web项目">Maven快速开发web项目</h2><p>同任何Maven项目一样，Maven对Web项目的布局也有一个通用的约定，首先要记住的是用户必须为Web项目显式指定打包方式为war.使用<code>jetty-maven-plugin</code>进行web测试,它能够周期性地检查项目内容，发现变更后自动更新到内置 的Jetty web容器中。换句话说，它帮我们省去了打包和部署的步骤。在通常情况下，我们只需要直接在IDE中修改源码，IDE能够执行自动编译，jetty-maven-plugin发现编译后的文件变化后，自动将其更新到Jetty容器。使用它非常简单</p>
<pre><code><span class="comment">&lt;!--使用jetty-maven-plugin--&gt;</span>
   <span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.mortbay.jetty<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifacetId</span>&gt;</span>jetty-maven-plugin<span class="tag">&lt;/<span class="title">artifacetId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>7.16<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
     <span class="tag">&lt;<span class="title">scanIntervalSeconds</span>&gt;</span>10<span class="tag">&lt;/<span class="title">scanIntervalSeconds</span>&gt;</span>
     <span class="tag">&lt;<span class="title">webAppconfig</span>&gt;</span>
      <span class="tag">&lt;<span class="title">contextPath</span>&gt;</span>/test<span class="tag">&lt;/<span class="title">contextPath</span>&gt;</span><span class="comment">&lt;!--表示用户可以通过http://hostname:port/text/访问该应用--&gt;</span>
     <span class="tag">&lt;/<span class="title">webAppconfig</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
   <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
</code></pre><p>下一步启动jetty-maven-plugin。在此之前需要对<code>settings.xml</code>做个微小的修改。默认情况下只有<code>org.apache.maven.plugins</code>和<code>org.codehaus.mojo</code>两个groupId下的插件才支持简化的命令行调用，即可以运行mvn help: system,但<code>mvn jetty: run</code>就不行。因为jetty-maven-plugin的groupId是org.mortbay.jetty。为了能在命令行直接运行<code>mvn jetty: run</code>用户需要配置settings.xml如下</p>
<pre><code><span class="tag">&lt;<span class="title">settings</span>&gt;</span>
    <span class="tag">&lt;<span class="title">pluginGroups</span>&gt;</span>
        <span class="tag">&lt;<span class="title">pluginGroup</span>&gt;</span>org.mortbay.jetty<span class="tag">&lt;/<span class="title">pluginGroup</span>&gt;</span>
    <span class="tag">&lt;<span class="title">pluginGroups</span>&gt;</span>
<span class="tag">&lt;/<span class="title">settings</span>&gt;</span>
</code></pre><p>默认是8080端口，如果希望使用其他端口，可以添加jetty.port参数 <code>mvn jetty:run -Djetty.port=9999</code></p>
<p>启动Jetty后，用户可以在IDE中修改各类文件，如jsp,html,css,javascript甚至于java类。只要不是修改类名，方法名等较大的操作，jetty-maven-plugin都能扫描到变更并正确地将变化更新到Web容器中。</p>
<h2 id="Maven的持续集成">Maven的持续集成</h2><p>Maven可以与hudson工具等对项目进行持续化集成,简单地说，持续集成就是快速且高频率地自动构建项目的所有源码，并为项目成员提供丰富的反馈信息。</p>
<h2 id="Maven与自动化部署">Maven与自动化部署</h2><p>Cargo能够帮助用户实现自动化部署，它通过<code>cargo-maven2-plugin</code>提供了Maven集成。它几乎支持所有的Web容器。虽然它与jetty-maven-plugin的功能看起来相似，但它们的目的是不同的，jetty-maven-plugin主要有来帮助日常的快速开发和测试，而cargo-maven2-plugin主要服务于自动化部署。如专门的测试人员只需要一条简单的Maven命令，就可以构建项目并部署到Web容器，然后进行功能测试。</p>
<p>它支持两种本地部署方式，分别是<code>standalone</code>模式和<code>existing</code>模式。</p>
<p>在standalone模式中，它会从web容器的安装目录复制一份配置到用户指定的目录，然后在此基础上部署应用，每次重新构建的时候，这个目录都会被清空，所有配置被重新生成。而在<code>exiting</code>模式中，用户需要指定现有的web容器配置目录，然后它会直接使用这些配置并将应用部署到其对应的位置。</p>
<pre><code><span class="comment">&lt;!--使用cargo自动化部署--&gt;</span>
   <span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.codehaus.cargo<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>cargo-maven2-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
     <span class="tag">&lt;<span class="title">container</span>&gt;</span>
      <span class="tag">&lt;<span class="title">containerId</span>&gt;</span>tomcat6x<span class="tag">&lt;/<span class="title">containerId</span>&gt;</span>
      <span class="tag">&lt;<span class="title">home</span>&gt;</span>d:\cmd\apache-tomcat-6.21<span class="tag">&lt;/<span class="title">home</span>&gt;</span> 
     <span class="tag">&lt;/<span class="title">container</span>&gt;</span>
     <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
      <span class="tag">&lt;<span class="title">type</span>&gt;</span>standalone<span class="tag">&lt;/<span class="title">type</span>&gt;</span>
      <span class="tag">&lt;<span class="title">home</span>&gt;</span>${project.build.directory}/tomecat6x<span class="tag">&lt;/<span class="title">home</span>&gt;</span>
     <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
   <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
</code></pre><p>在setting.xml中加入引插件，在命令行中输入<code>mvn cargo:start</code>就可以启动了。其它类似，如果要部署到远程web容器，就要提供拥有该容器的相应管理员权限。</p>
<p>远程部署：</p>
<pre><code><span class="comment">&lt;!--使用cargo自动化部署到远程web容器--&gt;</span>
   <span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.codehaus.cargo<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>cargo-maven2-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
     <span class="tag">&lt;<span class="title">container</span>&gt;</span>
      <span class="tag">&lt;<span class="title">containerId</span>&gt;</span>tomcat6x<span class="tag">&lt;/<span class="title">containerId</span>&gt;</span>
      <span class="tag">&lt;<span class="title">home</span>&gt;</span>remote<span class="tag">&lt;/<span class="title">home</span>&gt;</span><span class="comment">&lt;!--远程部署也必须是remot--&gt;</span>
     <span class="tag">&lt;/<span class="title">container</span>&gt;</span>
     <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
      <span class="tag">&lt;<span class="title">type</span>&gt;</span>runtime<span class="tag">&lt;/<span class="title">type</span>&gt;</span>

      <span class="tag">&lt;<span class="title">properties</span>&gt;</span>
       <span class="tag">&lt;<span class="title">cargo.remote.username</span>&gt;</span>admin<span class="tag">&lt;/<span class="title">cargo.remote.username</span>&gt;</span>
       <span class="tag">&lt;<span class="title">cargo.remote.password</span>&gt;</span>admin<span class="tag">&lt;/<span class="title">cargo.remote.password</span>&gt;</span>
       <span class="tag">&lt;<span class="title">cargo.tomcat.manager.url</span>&gt;</span>http://localhost:8080/manager<span class="tag">&lt;/<span class="title">cargo.tomcat.manager.url</span>&gt;</span>
      <span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
     <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
   <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
</code></pre><p>运行命令<code>mvn cargo:redeploy</code>就可以执行了。如果容器已经部署了当前应用，Cargo会先卸载，然后再重新部署</p>
<h2 id="版本管理">版本管理</h2><ul>
<li><p><strong>主干（trunk）</strong>:项目开发代码的主体，是从项目开始直到当前都处于活动的状态。从这里可以获得项目最新的源代码以及几乎所有变更历史</p>
</li>
<li><p><strong>分支（branch）</strong>:从主干的某个点分离出来的代码拷贝，通常可以在不影响主干的前提下在这里进行重大Bug的修复，或者做一些实验性质的开发。如果分支达到了预期的目的，通常发生在这里的变更会被合并（merge）到主干中。</p>
</li>
<li><p><strong>标签（tag）</strong>用来标识主干或者分支的某个点的状态，以代表项目的某个稳定状态。这通常就是版本发布时的状态。</p>
</li>
</ul>
<h2 id="Maven与项目release">Maven与项目release</h2><p><code>Maven Release Plugin</code>可以帮助我们发布项目版本</p>
<p>它主要有三个目标：</p>
<ol>
<li><p>release:prepare依次执行以下操作 </p>
<ul>
<li>检查项目是否有未提交的代码</li>
<li>检查项目是否有快照版本依赖</li>
<li>根据用户的输入将快照版本升级为发布版</li>
<li>将POM中的SCM信息更新为标签地址</li>
<li>基于修改后的POM执行Maven构建</li>
<li>提交POM变更</li>
<li>基于用户输入为代码打标签</li>
<li>将代码从发布版本升级为新的快照版</li>
<li>提交POM变更</li>
</ul>
</li>
<li><p>releas:rollback   回退release:prepare所执行的操作，将POM回退至release:prepare之前的状态，并提交。需要注意的是，该步骤不会删除release:prepare生成的标签，因此用户需要手动删除</p>
</li>
<li><p>release:perform    执行版本发布。签出<code>release:prepare</code>生成的标签中的源代码，并在此基础上执行<code>mvn deploy</code>命令打包并部署构件至仓库。</p>
</li>
</ol>
<p>要为项目发布版本，首先需要为其添加正确的版本控制系统信息，因为Maven Release Plugin需要知道版本控制系统的主干，标签等地址信息后才能执行相关的操作。</p>
<pre><code>&lt;scm&gt;
    &lt;connection&gt;<span class="string">scm:</span><span class="string">svn:</span><span class="string">http:</span><span class="comment">//....app/trunk&lt;/connection&gt;</span>
    &lt;developerConnection&gt;<span class="string">scm:</span><span class="string">svn:</span><span class="string">https:</span><span class="comment">//..../app/trunk&lt;/developerConnection&gt;</span>
    &lt;url&gt;<span class="string">http:</span><span class="comment">//.../account/trunk&lt;/url&gt;</span>
&lt;/scm&gt;
</code></pre><p>上述代码中，connectin表示一个只读的scm地址，而developerConnection元素表示可写的scm地址，url则表示可以浏览器中访问的scm地址。为了能让Maven识别，connection和developerConnection必须以scm开头，冒号之后的部分表示版本控制工具类型。接下来才是实际的scm地址。</p>
<p>该配置只告诉Maven当前代码的位置（主干），而版本发布还要涉及标签操作。因此还要配置Maven Release Plugin告诉其标签的基础目录</p>
<pre><code><span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifacetId</span>&gt;</span>maven-release-plugin<span class="tag">&lt;/<span class="title">artifacetId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
        <span class="tag">&lt;<span class="title">tagBase</span>&gt;</span>https://localhost/app/tags<span class="tag">&lt;/<span class="title">tagBase</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
<span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
</code></pre><h2 id="利用Maven自动化创建分支：">利用Maven自动化创建分支：</h2><p>在正式版本1.1.0发布的同时，还可以创建一个分支用来修复将来这个版本可能遇到的重大bug。这个过程可以手工完成。如使用svn的copy操作将主干代码复制到一个名为1.1.x的分支中，然后修改分支中的pom文件，升级其版本为1.1.1-snapshot</p>
<p>使用<code>Maven Release Plugin</code>的<code>branch</code>目标，它能够帮我们自动化这些操作：</p>
<ul>
<li>检查本地有无未提交的代码</li>
<li>为分支更改POM的版本，</li>
<li>将POM中的SCM信息更新为分支地址</li>
<li>提交以上更新</li>
<li>将主干的代码复制到分支中</li>
<li>修改本地代码使其回退到分之前的版本（用户可以指定新的版本）</li>
<li>提交本地更改</li>
</ul>
<p>当然，为了让它为我们工作，和版本发布一样，必须在在pom中提供正确的scm信息，此外，由于分支操作会涉及版本控制系统里的分支地址，因此还要为它配置分支基础目录</p>
<pre><code><span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifacetId</span>&gt;</span>maven-release-plugin<span class="tag">&lt;/<span class="title">artifacetId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
        <span class="tag">&lt;<span class="title">tagBase</span>&gt;</span>https://localhost/app/tags/<span class="tag">&lt;/<span class="title">tagBase</span>&gt;</span>
        <span class="tag">&lt;<span class="title">branchBase</span>&gt;</span>https://localhost/app/branches/<span class="tag">&lt;/<span class="title">branchBase</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
<span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
</code></pre><p>现在运行命令：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mvn release:branch -DbranchName = 1.1.x \ -DuddateBranchVersions = true -DupdateWorkingCopyVersions = false</div></pre></td></tr></table></figure></p>
<p><code>-DbranchName = 1.1.x</code> 用来配置所有创建分支的名称。</p>
<p><code>-DupdateBranchVersions = true</code>表示为分支使用新的版本。</p>
<p><code>-DupdateWorkingCopyVersion = false</code>表示不更新本地代码（即主干）的版本。</p>
<p>运行上述命令后，Maven会提示输入项目分支的版本</p>
<h2 id="Maven与签名：">Maven与签名：</h2><p>手动地对Maven构件进行签名并将这些签名部署到Maven仓库是一件耗时的体力活。而使用<code>Maven GPG Plugin</code>只需要提供几行简单的配置，它就能够帮我们自动完成签名这一工作。</p>
<pre><code><span class="comment">&lt;!--使用GPG给构件加签名--&gt;</span>
   <span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifacetId</span>&gt;</span>maven-gpg-plugin<span class="tag">&lt;/<span class="title">artifacetId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">executions</span>&gt;</span>
     <span class="tag">&lt;<span class="title">execution</span>&gt;</span>
      <span class="tag">&lt;<span class="title">id</span>&gt;</span>sign-artifacts<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
      <span class="tag">&lt;<span class="title">phase</span>&gt;</span>verify<span class="tag">&lt;/<span class="title">phase</span>&gt;</span>
      <span class="tag">&lt;<span class="title">goals</span>&gt;</span>
       <span class="tag">&lt;<span class="title">goal</span>&gt;</span>sign<span class="tag">&lt;/<span class="title">goal</span>&gt;</span>
      <span class="tag">&lt;/<span class="title">goals</span>&gt;</span>
     <span class="tag">&lt;/<span class="title">execution</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">executions</span>&gt;</span>
   <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
</code></pre><p>然后使用一般mvn命令签名并发布项目构件：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mvn clean deploy -Dgpg.passphrase = yourpassphrase</div></pre></td></tr></table></figure></p>
<p>如果不提供<code>-Dgpg.passphrase</code>参数，运行时就会要求输入密码</p>
<h1 id="Maven灵活的构建：">Maven灵活的构建：</h1><p>Maven为了支持灵活的构建，内置了三大特性，即<em>属性，Profile和资源过滤</em>。</p>
<h2 id="Maven属性">Maven属性</h2><p>maven有6类属性</p>
<ol>
<li>内置属性： 主要有两个内置属性<code>${basedir}</code>表示项目的根目录，即包含<code>pom.xml</code>文件的目录。<code>${version}</code>表示项目版本</li>
<li><p>POM属性 用户可以使用该类属性引用POM文件中对应元素的值。如 <code>${project.artifactId}</code>对应<code>&lt;project&gt;&lt;artifactId&gt;</code>元素的值。</p>
<ul>
<li>${project.build.sourceDirectory}项目主源码目录 默认src/main/java</li>
<li>${project.build.testSourceDirectory}</li>
<li>${project.build.directory}     默认target/</li>
<li>${project.outputDirectory}项目主代码编译输出目录 默认为target/classes/</li>
<li>${project.build.finalName}项目打包输出文件的名称，默认为${project.artifactId}-${project.version}<br>这些属性都对应了一个POM元素，它们中的一些属性默认值都是在超级POM中定义的</li>
</ul>
</li>
<li><p>自定义属性：用户可以POM的<properties>元素下自定义Maven属性如：</properties></p>
<p> 　　<properties></properties></p>
<pre><code>　　 &lt;<span class="keyword">my</span>.<span class="keyword">prop</span>&gt;hello&lt;/<span class="keyword">my</span>.<span class="keyword">prop</span>&gt;
</code></pre><p> 　　<br>然后在POM的其他地方使用${my.prop}的时候会被替换成hello</p>
</li>
<li><p>Settings属性:与POM属性同理，用户使用以settings开关的属性引用settings.xml文件中XmL元素的值。如常用 的<code>${setttings.localRespository}</code>指向用户本地仓库的地址。</p>
</li>
<li><p>Java系统属性  所有Java系统属性都可以使用Maven属性引用 。如<code>${user.home}</code>指向了用户目录。用户可以使用<code>mvn help:system</code>查看所有的Java系统属性</p>
</li>
<li><p>环境变量 ：所有环境变量都可以使用以<code>env.</code>开头的Maven属性引用。如<code>${env.JAVA_HOME}</code>指代了JAVA_HOM环境变量的值。用户可以使用<code>mvn help:system</code>查看所有环境变量</p>
</li>
</ol>
<p>正确使用这些Maven的属性可以帮助我们简化POM的配置和维护工作。</p>
<h2 id="资源过滤">资源过滤</h2><p>为了应对环境的变化，首先需要使用Maven属性将这些将会发生变化的部分提取出来。如数据库配置中，连接数据库使用的驱动类，URL，用户名和密码都可能发生变化，因此用maven属性取代它们：<br>　　<br>    database.jdbc.driverClass=${db.driver}<br>    database.jdbc.connectionURL=${db.url}<br>    database.jdbc.username=${db.username}<br>    database.jdbc.password=${db.password}<br>既然使用了maven属性，就应该在某个地方定义它们，这里使用一个额外的profile将其包裹：</p>
<pre><code><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
 <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
  <span class="tag">&lt;<span class="title">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
  <span class="tag">&lt;<span class="title">properties</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.driver</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="title">db.driver</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.url</span>&gt;</span>jdbc:mysql://localhost:3306/test<span class="tag">&lt;/<span class="title">db.url</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.username</span>&gt;</span>dev<span class="tag">&lt;/<span class="title">db.username</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.password</span>&gt;</span>dev-pwd<span class="tag">&lt;/<span class="title">db.password</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</code></pre><p>这里Maven属性定义与直接在POM的properties元素下定义并无二致，这里使用一个id为dev的profile，其目的是将开发环境下的配置与其他环境区别开来。</p>
<p>有了属性定义，配置文件中也使用了这些属性。这还不行，Maven属性默认只有在POM中才会被解析，也就是说，<code>${db.username}</code>放到POM中会就test，但是如果放到src/main/resources/目录下的文件中，构建的时候它将仍然还是${db.username}，因此，需要让Maven解析资源文件中的Maven属性。</p>
<p>资源文件的处理其实是<code>maven-resource-plugin</code>做的事情，它默认的行为只是将项目主资源文件复制到主代码编译输出目录中，将测试资源文件复制到测试代码编译输出目录中。不过只要通过一些简单的POM配置，该插件就能够解析资源文件中的Maven属性，即开启资源过滤。</p>
<p>Maven默认的主资源目录和测试资源目录的定义是在超级POM中，要为资源目录过滤，只要在此基础上添加一行filtering配置即可，</p>
<pre><code><span class="tag">&lt;<span class="title">resources</span>&gt;</span>
    <span class="tag">&lt;<span class="title">resource</span>&gt;</span>
        <span class="tag">&lt;<span class="title">directory</span>&gt;</span>${project.basedir}/src/main/resoureces<span class="tag">&lt;/<span class="title">directory</span>&gt;</span>
<span class="tag">&lt;<span class="title">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="title">filtering</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">resource</span>&gt;</span>
<span class="tag">&lt;/<span class="title">resources</span>&gt;</span>
</code></pre><p>类似地可以为测试资源目录开启过滤。<br>到目前为止一切基本就绪了，我们将数据库配置的变化部分提取成了Maven属性，在POM的profile中定义了这些属性的值，并且为资源目录开启了属性过渡。最后，只需要在命令行激活profile，Maven就能够在构建项目的时候使用profile中属性值替换数据库配置文件中的属性引用。运行命令如下：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mvn clean install -Pdev</div></pre></td></tr></table></figure></p>
<p>-P参数表示在命令行激活一个profile。这里激活了id为dev的profile.构建完成后，输出目录中的数据库配置就是开发环境的配置了。</p>
<h2 id="Maven_Profile">Maven Profile</h2><p>从前面内容我们可以看到，不同环境的构建很可能是不同的，典型的情况就是数据库配置。除此之外，有些环境可能需要配置插件使用本地文件，或者使用特殊版本的依赖，或者需要一个特殊的构件名称。为了能让构建在各个环境下方便地移植，Maven引入了profile概念。</p>
<p>profile能够在构建的时候修改POM的一个子集，或者添加额外的配置元素。用户可以使用很多方式激活profile，以实现构建在不同环境下的移植。</p>
<p>继续以数据库为例，如下配置引入了一个针对开发环境的profile，类似还可以加入测试环境和产品环境profile</p>
<pre><code><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
 <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
  <span class="tag">&lt;<span class="title">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
  <span class="tag">&lt;<span class="title">properties</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.driver</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="title">db.driver</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.url</span>&gt;</span>jdbc:mysql://localhost:3306/dev<span class="tag">&lt;/<span class="title">db.url</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.username</span>&gt;</span>dev<span class="tag">&lt;/<span class="title">db.username</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.password</span>&gt;</span>dev-pwd<span class="tag">&lt;/<span class="title">db.password</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
 <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
  <span class="tag">&lt;<span class="title">id</span>&gt;</span>test<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
  <span class="tag">&lt;<span class="title">properties</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.driver</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="title">db.driver</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.url</span>&gt;</span>jdbc:mysql://localhost:3306/test<span class="tag">&lt;/<span class="title">db.url</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.username</span>&gt;</span>test<span class="tag">&lt;/<span class="title">db.username</span>&gt;</span>
   <span class="tag">&lt;<span class="title">db.password</span>&gt;</span>test-pwd<span class="tag">&lt;/<span class="title">db.password</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
 <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</code></pre><p>同样的属性在两个profile中的值是不一样的，dev profile是开发环境数据库的配置，而test profile提供的是测试环境数据库的配置。现在开发人员可以使用mvn命令的时候在后面加上-Pdev激活dev profile，而测试人员可以使用-Ptest激活test Profile</p>
<h3 id="Profile激活">Profile激活</h3><p>为了方便用户，Maven支持多种激活Profile方式：</p>
<ol>
<li><p>命令行激活<br> 用户可以使用mvn命令行参数-P加上profile的id来激活profile，多个id之间可以逗号分隔。如下激活了dev -x和dev -y两个profile</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mvn clean install -Pdev -x,dev -y</div></pre></td></tr></table></figure>
</li>
<li><p>settings文件显示激活<br> 如果用户希望某个profile默认一直处于激活状态，就可以配置settings.xml文件的activeProfiles元素，表示其配置的profile对于所有项目都处于激活状态。</p>
<pre><code><span class="tag">&lt;<span class="title">settings</span>&gt;</span>
    <span class="tag">&lt;<span class="title">activeProfiles</span>&gt;</span>
        <span class="tag">&lt;<span class="title">activeProfile</span>&gt;</span>dev -x<span class="tag">&lt;/<span class="title">activeProfile</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">activeProfiles</span>&gt;</span>
<span class="tag">&lt;/<span class="title">settings</span>&gt;</span>
</code></pre></li>
<li><p>系统属性激活<br> 用户可能配置当某系统属性存在的时候，自动激活profile</p>
<pre><code><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">activation</span>&gt;</span>
            <span class="tag">&lt;<span class="title">property</span>&gt;</span>
                <span class="tag">&lt;<span class="title">name</span>&gt;</span>test<span class="tag">&lt;/<span class="title">name</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">property</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">activation</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</code></pre><p> 可以进一步配置当某系统属性test存在，且值等于x时激活profile</p>
<pre><code><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">activation</span>&gt;</span>
            <span class="tag">&lt;<span class="title">property</span>&gt;</span>
                <span class="tag">&lt;<span class="title">name</span>&gt;</span>test<span class="tag">&lt;/<span class="title">name</span>&gt;</span>
                <span class="tag">&lt;<span class="title">value</span>&gt;</span>x<span class="tag">&lt;/<span class="title">value</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">property</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">activation</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</code></pre><p> 不要忘记，用户可以在命令行声明系统属性如：</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mvn clean install -Dtest=x</div></pre></td></tr></table></figure>
<p> 因此这其实是一种从命令行激活profile的方法，而且多个profile完全可以使用同一个系统属性来激活</p>
</li>
<li><p>操作系统属性激活<br> profile还可以自动根据操作系统环境激活，如果构建在不同的操作系统有差异，用户完全可以将这些差异写进profile，然后配置它们自动基于操作系统环境激活。</p>
<pre><code><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">activation</span>&gt;</span>
            <span class="tag">&lt;<span class="title">os</span>&gt;</span>
                <span class="tag">&lt;<span class="title">name</span>&gt;</span>Windows XP<span class="tag">&lt;/<span class="title">name</span>&gt;</span>
                <span class="tag">&lt; <span class="attribute">family</span>&gt;</span>Windows<span class="tag">&lt;/<span class="title">family</span>&gt;</span>
                <span class="tag">&lt;<span class="title">arch</span>&gt;</span>x86<span class="tag">&lt;/<span class="title">arch</span>&gt;</span>
                <span class="tag">&lt;<span class="title">version</span>&gt;</span>5.1.2600<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">os</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">activation</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</code></pre><p> 这里family会值包括Windows,UNIX和Mac等，其它几项，name,arch,versin,用户可以通过查看环境中和系统属性os.name.os.arch.os.version获得</p>
</li>
<li><p>文件存在与否激活<br> Maven能够根据项目中某个文件存在与否决定是否激活profile</p>
<pre><code><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">activation</span>&gt;</span>
            <span class="tag">&lt;<span class="title">file</span>&gt;</span>
                <span class="tag">&lt;<span class="title">missing</span>&gt;</span>x.properties<span class="tag">&lt;/<span class="title">missing</span>&gt;</span>
                <span class="tag">&lt;<span class="title">exists</span>&gt;</span>y.properties<span class="tag">&lt;/<span class="title">exists</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">file</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">activation</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</code></pre></li>
<li><p>默认激活</p>
<p> 用户可以在定义profile的时候指定其默认激活</p>
<pre><code><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
        <span class="tag">&lt;<span class="title">activation</span>&gt;</span>
            <span class="tag">&lt;<span class="title">activeByDefalut</span>&gt;</span>true<span class="tag">&lt;/<span class="title">activeByDefault</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">activation</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</code></pre><p> 使用activeByDefault元素用户可以指定profile自动激活，需要注意的是，如果POM中有任何一个profile通过以上其他任意一种方式激活了，所有的默认激活配置都会失效。<br> mvn提供了一个目标帮助用户了解当前激活的profile:</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mvn help:active-profiles</div></pre></td></tr></table></figure>
<p> mvn还有另外一个目标用来列出当前所有的profile</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mvn help:all-profiles</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="profile的种类">profile的种类</h3><p>根据具体需要，可以在以下位置声明profile，</p>
<ul>
<li>pom.xml  很显然pom.xml中声明的profile只对当前项目有效</li>
<li>用户setting.xml，用户目录下.ml/settings.xml中的profile对本机上该用户所有的Maven项目有效</li>
<li>全局settings.xml .Maven安装目录下conf/settings.xml中的profile对本机上所有的Maven项目有效</li>
<li>profiles.xml 还可以在项目根目录下使用一个额外的profiles.xml文件来声明profile，不过该特性已经在Maven3中被移除，建议用户将这类profile移到settings.xml中</li>
</ul>
<h2 id="web资源过滤、">web资源过滤、</h2><p>在web项目中，资源文件同样位于<code>src/main/resources/</code>目录下，它们经处理后会位于war包的<code>WEB_INF/classes</code>目录下，这也是Jave代码编译打包后的目录。也就是说，这类资源文件在打包过后位于应用程序的classpath中。web项目中还有另外一类资源文件，默认它们的源码文件位于<code>src/main/webapps/</code>目录，经打包后位于war包根目录。如一个web项目的css源码文件在<code>src/main/webapp/css/</code>目录，项目打包后在war包的css/目录下找到对应的css文件。这一类资源文件称为web资源文件，它们在打包后不位于应用程序的classpath中。与一般的资源文件一样，web资源文件默认不会被过滤，开启一般资源文件的过滤也不会影响到web资源文件。</p>
<p>不过有的时候，我们可能希望在构建项目的时候，为不同的客户使用不一样的资源文件。这时可以在web资源文件中使用Maven属性。然后使用profile分别定义这些maven属性的值。最后需要配置<code>maven-war-plugin</code>对src/main/webapp/这一web资源目录开启过滤</p>
<pre><code><span class="comment">&lt;!--开启web资源过滤--&gt;</span>
   <span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
     <span class="tag">&lt;<span class="title">webResources</span>&gt;</span>
      <span class="tag">&lt;<span class="title">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="title">filtering</span>&gt;</span>
      <span class="tag">&lt;<span class="title">directory</span>&gt;</span>src/main/webapp<span class="tag">&lt;/<span class="title">directory</span>&gt;</span>
      <span class="tag">&lt;<span class="title">includes</span>&gt;</span>
       <span class="tag">&lt;<span class="title">include</span>&gt;</span>**/*.css<span class="tag">&lt;/<span class="title">include</span>&gt;</span>
       <span class="tag">&lt;<span class="title">include</span>&gt;</span>**/*.js<span class="tag">&lt;/<span class="title">includes</span>&gt;</span>
      <span class="tag">&lt;/<span class="title">includes</span>&gt;</span>
     <span class="tag">&lt;/<span class="title">webResources</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
   <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
</code></pre><h1 id="Maven与自动化站点生成">Maven与自动化站点生成</h1><p>Maven不仅仅是一个自动化构建工具和一个依赖管理工具，它还能够帮助聚合项目信息，促进团队间的交流。POM可以包含各种项目信息，如项目描述，版本控制系统地址，缺陷跟踪系统地址，许可证信息，开发者信息等。用户可以让Maven自动生成一个web站点，以web的形式发布这些信息。此外，Maven社区提供了大量插件，能让用户生成各种各样的项目审查报告，包括测试覆盖率，静态代码分析，代码变更等。使用maven-site-plugin插件</p>
<h1 id="Maven与代码检查及代码分析">Maven与代码检查及代码分析</h1><p>checkstyle代码检查插件,PMD是一款强大的源代码分析工具，它能够寻找代码中的问题，包括潜在的bug，无用代码，可优化代码，重复代码以及过于复杂的表达式。<a href="http://pmd.sourceforge.net/" target="_blank" rel="external">http://pmd.sourceforge.net/</a><br>要让Maven在站点生成PMD报告，只需要配置<code>maven-pmd-plugin</code></p>
<p>Maven用户可以直接从命令行获得Effective POM（所有父pom及超级pom）,<code>mvn help:effective -pom</code></p>
<p>m2eclipse能够自动下载并使用依赖的源码包。用户在项目上右击，选择Maven，再选择Download Sources让m2eclipse为当前项目的依赖下载源码包</p>
<h1 id="编写Maven插件的一般步骤">编写Maven插件的一般步骤</h1><p>创建一个maven-plugin项目，插件本身也是Maven项目，特殊的地方在于它的packaging必须是maven-plugin，用户可以使用maven-archetype-plugin快速创建一个Maven插件项目</p>
<p>为插件编写目标。每个插件都必须以包含一个或多个目标。Maven称之为Mojo(与pojo相对应)。编写插件的时候必须提供一个或多个继承自<code>AbstractMojo</code>的类</p>
<p>为目标提供配置点，大部分Maven插件及其目标都是可以配置的，因此在编写Mojo的时候需要注意提供可配置的参数</p>
<p>编写代码实现目标行为：根据实际需要实现Mojo</p>
<p>错误处理及日志，当Mojo发生异常时，根据情况控制Maven的运行状态。在代码中编写必要的日志便为用户提供足够的信息</p>
<p>测试插件：编写自动化的测试代码测试行为，然后再实际运行插件以验证其行为</p>
<p>创建一个Mojo所我必要的三项是：继承AbstractMojo,实现execute()方法，提供@goal标注</p>
<h1 id="常用archetype介绍">常用archetype介绍</h1><p>到目前为止，Maven仓库中已经包含了249个archetype(<a href="http://repol.maven.org/maven2/archetype-catalog.xml" target="_blank" rel="external">http://repol.maven.org/maven2/archetype-catalog.xml</a>)</p>
<p>此外还有大量的没有发布到中央仓库中，<br>比较常见的是：</p>
<p><code>maven-archetype-quicksart</code>  最常见的java项目基本骨架</p>
<p><code>maven-archetype-webapp</code>  最简单的Maven war项目的模板<br><code>AppFuse  Archetype</code> AppFuse是一个集成了很多开源工具的项目，它由Matt Raible开发，旨在帮助 Jave编程人员快速高效地创建项目。AppFuse本身使用Maven构建，它的核心其实就是一个项目的骨架，是包含持久层，业务和展现层的一个基本结构。在AppFuse2.x中，已经集成了大量流行的开源工具，如Spring,Struts2,JPA,JSF,Tapestry等</p>
<p>AppFuse 为用户提供了大量Archetype，以方便用户快速创建各类型的项目，它们都使用同样的<code>groupId org.appfuse</code>.针对各种展现层分别为：</p>
<p><code>appfuse-*-jsf</code>:基于JSF展现层框架的Archetype<br><code>appfuse-*-spring</code>：基于Spring MVC展现框架的Archetype<br><code>appfuse-*-struts</code>:基于struts2展现层框架的Archetype<br><code>appfuse-*-tapestry</code>：基于Tapestry展现框架的Archetype</p>
<p>每一种展现层框架都有3个Archetype，分别为<em>light,basic和modular</em>，其中，light类型的Archetype只包含最简单的骨架，basic类型的Archetype则包含了一些用户管理及安全方面的特性。modular类型的Archetype会生成多模块的项目，其中的core模块包含了持久层及业务层的代码，而Web模块则是展现层的代码。</p>
<p>更多AppFuse 的信息可以访问官方入门手册：<a href="http://appfuse.org/display/apf/appfuse+quickstart" target="_blank" rel="external">http://appfuse.org/display/apf/appfuse+quickstart</a></p>
<p>我们也可以自己动手编写一个archetype</p>
<h1 id="Maven常用插件列表：">Maven常用插件列表：</h1><p><code>maven-clean-plugin</code> 清理项目</p>
<p><code>maven-compile-plugin</code> 编译项目</p>
<p><code>maven-deply-plugin</code> 部署项目`</p>
<p><code>maven-install-plugin</code> 安装项目</p>
<p><code>maven-resource-plugin</code> 处理资源文件</p>
<p><code>maven-site-plugin</code> 生成站点</p>
<p><code>maven-surefire-plugin</code> 执行测试</p>
<p><code>maven-jar-plugin</code> 构建JAR项目</p>
<p><code>maven-war-plugin</code> 构建WAR项目</p>
<p><code>maven-shade-plugin</code> 构建包含依赖的JAR包</p>
<p><code>maven-changelog-plugin</code> 生成版本控制变更报告</p>
<p><code>maven-checkstyle-plugin</code> 生成CheckStyle报告 </p>
<p><code>maven-javadoc-plugin</code> 生成JavaDoc文档</p>
<p><code>maven-jxr-plugin</code> 生成源码交叉引用文档</p>
<p><code>maven-pmd-plugin</code> 生成PMD报告</p>
<p><code>maven-project-info-reports-plugin</code> 生成项目信息报告</p>
<p><code>maven-surefire-report-plugin</code> 生成单元测试报告</p>
<p><code>maven-antrun-plugin</code> 调用Ant任务</p>
<p><code>maven-archetype-plugin</code>  基于Archetype 生成项目骨架</p>
<p><code>maven-assembly-plugin</code> 构建自定义格式的分发包</p>
<p><code>maven-dependency-plugin</code> 依赖分析及控制</p>
<p><code>maven-enforcer-plugin</code> 定义规则并强制要求项目遵守</p>
<p><code>maven-pgp-plugin</code> 为项目构件生成pgp签名</p>
<p><code>maven-help-plugin</code> 获取项目及Maven环境的信息</p>
<p><code>maven-invoker-plugin</code> 自动运行Maven项目构建并验证</p>
<p><code>maven-release-plugin</code> 自动化项目版本发布</p>
<p><code>maven-scm-plugin</code> 集成版本控制系统</p>
<p><code>maven-source-plugin</code> 生成源码包</p>
<p><code>maven-eclipse-plugin</code> 生成Eclipse项目环境配置</p>
<p><code>build-helper-maven-plugin</code> 包含各种支持构建生命周期的目标</p>
<p><code>exec-maven-plugin</code> 运行系统程序或者Java程序</p>
<p><code>jboss-maven-plugin</code> 启动，停止Jboss部署项目</p>
<p><code>properties-maven-plugin</code> 从properties文件读写Maven属性</p>
<p><code>sql-maven-plugin</code> 运行SQL脚本</p>
<p><code>tomcat-maven-plugin</code> 启动，停止Tomcat,部署项目</p>
<p><code>version-maven-plugin</code> 自动化批量更新POM版本</p>
<p><code>cargo-maven-plugin</code> 启动、停止、配置各类web容器自动化部署web项目</p>
<p><code>jetty-maven-plugin</code> 集成Jetty容器，实现快速开发测试</p>
<p><code>maven-gae-plugin</code> 集成Google App Engine</p>
<p><code>maven-license-plugin</code> 自动化添加许可证证明至源码文件</p>
<p><code>maven-android-plugin</code> 构建Android项目<br>可以去Apaceh，Codehaus,Googlecode上找到完整的插件列表。</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术辅助/">技术辅助</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/技术/">技术</a><a href="/tags/项目构建/">项目构建</a><a href="/tags/maven/">maven</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://wn398.github.io/2014/04/08/Maven/" data-title="Maven | 自由之翼" data-tsina="tim398" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/03/11/android/活动-Activity/" title="活动-Activity">
  <strong>上一篇：</strong><br/>
  <span>
  活动-Activity</span>
</a>
</div>


<div class="next">
<a href="/2014/04/01/Java7中增加的新特性/"  title="Java7中增加的新特性">
 <strong>下一篇：</strong><br/> 
 <span>Java7中增加的新特性
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2014/04/08/Maven/" data-title="Maven" data-url="http://wn398.github.io/2014/04/08/Maven/"></div>
</section>


</div>
<script src="/js/snowstorm-min.js"></script>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven基本使用："><span class="toc-number">1.</span> <span class="toc-text">Maven基本使用：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#maven坐标"><span class="toc-number">1.1.</span> <span class="toc-text">maven坐标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven依赖"><span class="toc-number">1.2.</span> <span class="toc-text">Maven依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven仓库管理："><span class="toc-number">1.3.</span> <span class="toc-text">Maven仓库管理：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven生命周期："><span class="toc-number">1.4.</span> <span class="toc-text">Maven生命周期：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Clean生命周期"><span class="toc-number">1.4.1.</span> <span class="toc-text">Clean生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defaut生命周期"><span class="toc-number">1.4.2.</span> <span class="toc-text">defaut生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#site生命周期"><span class="toc-number">1.4.3.</span> <span class="toc-text">site生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命令行与生命周期"><span class="toc-number">1.4.4.</span> <span class="toc-text">命令行与生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生命周期与插件绑定"><span class="toc-number">1.4.5.</span> <span class="toc-text">生命周期与插件绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven的聚合与继承："><span class="toc-number">1.5.</span> <span class="toc-text">Maven的聚合与继承：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用Nexus创建私服"><span class="toc-number">1.6.</span> <span class="toc-text">使用Nexus创建私服</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven执行单个测试类"><span class="toc-number">1.7.</span> <span class="toc-text">Maven执行单个测试类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven快速开发web项目"><span class="toc-number">1.8.</span> <span class="toc-text">Maven快速开发web项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven的持续集成"><span class="toc-number">1.9.</span> <span class="toc-text">Maven的持续集成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven与自动化部署"><span class="toc-number">1.10.</span> <span class="toc-text">Maven与自动化部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#版本管理"><span class="toc-number">1.11.</span> <span class="toc-text">版本管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven与项目release"><span class="toc-number">1.12.</span> <span class="toc-text">Maven与项目release</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#利用Maven自动化创建分支："><span class="toc-number">1.13.</span> <span class="toc-text">利用Maven自动化创建分支：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven与签名："><span class="toc-number">1.14.</span> <span class="toc-text">Maven与签名：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven灵活的构建："><span class="toc-number">2.</span> <span class="toc-text">Maven灵活的构建：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven属性"><span class="toc-number">2.1.</span> <span class="toc-text">Maven属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#资源过滤"><span class="toc-number">2.2.</span> <span class="toc-text">资源过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven_Profile"><span class="toc-number">2.3.</span> <span class="toc-text">Maven Profile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Profile激活"><span class="toc-number">2.3.1.</span> <span class="toc-text">Profile激活</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#profile的种类"><span class="toc-number">2.3.2.</span> <span class="toc-text">profile的种类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web资源过滤、"><span class="toc-number">2.4.</span> <span class="toc-text">web资源过滤、</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven与自动化站点生成"><span class="toc-number">3.</span> <span class="toc-text">Maven与自动化站点生成</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven与代码检查及代码分析"><span class="toc-number">4.</span> <span class="toc-text">Maven与代码检查及代码分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#编写Maven插件的一般步骤"><span class="toc-number">5.</span> <span class="toc-text">编写Maven插件的一般步骤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#常用archetype介绍"><span class="toc-number">6.</span> <span class="toc-text">常用archetype介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven常用插件列表："><span class="toc-number">7.</span> <span class="toc-text">Maven常用插件列表：</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  <div>
<script charset="Shift_JIS" src="http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_wh.js"></script>
</div>


  <div class="music">
<!--<p class="asidetitle">Music</p>-->
<div class="music_player clearfix">
<script type="text/javascript" src="http://www.xiami.com/widget/player-single?uid=45521081&sid=381307&mode=js"></script>
</div>
</div>

  
<div class="categorieslist">
<p class="asidetitle">近期文章</p>
  <ul class="entry">
    
      <li>
        <a href="/2016/11/21/bootstrap基础/">bootstrap基础</a>
      </li>
    
      <li>
        <a href="/2016/11/21/Bootstrap插件/">bootstrap插件</a>
      </li>
    
      <li>
        <a href="/2016/09/18/xml基础要点/">xml基础要点</a>
      </li>
    
  </ul>
</div>


  
<div class="categorieslist">
<p class="asidetitle">近期更新</p>
  <ul class="entry">
    
      <li>
        <a href="/2016/11/21/bootstrap基础/">bootstrap基础</a>
      </li>
    
      <li>
        <a href="/2016/11/21/Bootstrap插件/">bootstrap插件</a>
      </li>
    
      <li>
        <a href="/2016/09/18/servlet3新特性/">servlet3新特性</a>
      </li>
    
      <li>
        <a href="/2016/09/18/struts2要点/">Struts2要点</a>
      </li>
    
      <li>
        <a href="/2016/09/18/hibernate要点/">hiberante要点</a>
      </li>
    
  </ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/技术/" title="技术">技术<sup>51</sup></a></li>
		
			<li><a href="/tags/android/" title="android">android<sup>17</sup></a></li>
		
			<li><a href="/tags/前端/" title="前端">前端<sup>7</sup></a></li>
		
			<li><a href="/tags/android-UI/" title="android_UI">android_UI<sup>6</sup></a></li>
		
			<li><a href="/tags/数据库/" title="数据库">数据库<sup>3</sup></a></li>
		
			<li><a href="/tags/bootstrap/" title="bootstrap">bootstrap<sup>2</sup></a></li>
		
			<li><a href="/tags/hibernate/" title="hibernate">hibernate<sup>2</sup></a></li>
		
			<li><a href="/tags/字节码/" title="字节码">字节码<sup>2</sup></a></li>
		
			<li><a href="/tags/JS/" title="JS">JS<sup>2</sup></a></li>
		
			<li><a href="/tags/ssh/" title="ssh">ssh<sup>2</sup></a></li>
		
			<li><a href="/tags/servlet/" title="servlet">servlet<sup>2</sup></a></li>
		
			<li><a href="/tags/java/" title="java">java<sup>2</sup></a></li>
		
			<li><a href="/tags/linux/" title="linux">linux<sup>2</sup></a></li>
		
			<li><a href="/tags/spring/" title="spring">spring<sup>1</sup></a></li>
		
			<li><a href="/tags/git/" title="git">git<sup>1</sup></a></li>
		
			<li><a href="/tags/Java新特性/" title="Java新特性">Java新特性<sup>1</sup></a></li>
		
			<li><a href="/tags/项目构建/" title="项目构建">项目构建<sup>1</sup></a></li>
		
			<li><a href="/tags/maven/" title="maven">maven<sup>1</sup></a></li>
		
			<li><a href="/tags/ssh2/" title="ssh2">ssh2<sup>1</sup></a></li>
		
			<li><a href="/tags/css/" title="css">css<sup>1</sup></a></li>
		
			<li><a href="/tags/html/" title="html">html<sup>1</sup></a></li>
		
			<li><a href="/tags/依赖注入/" title="依赖注入">依赖注入<sup>1</sup></a></li>
		
			<li><a href="/tags/grails/" title="grails">grails<sup>1</sup></a></li>
		
			<li><a href="/tags/JDK/" title="JDK">JDK<sup>1</sup></a></li>
		
			<li><a href="/tags/并发/" title="并发">并发<sup>1</sup></a></li>
		
			<li><a href="/tags/多线程/" title="多线程">多线程<sup>1</sup></a></li>
		
			<li><a href="/tags/Web/" title="Web">Web<sup>1</sup></a></li>
		
			<li><a href="/tags/jsp/" title="jsp">jsp<sup>1</sup></a></li>
		
			<li><a href="/tags/实例/" title="实例">实例<sup>1</sup></a></li>
		
			<li><a href="/tags/xml/" title="xml">xml<sup>1</sup></a></li>
		
			<li><a href="/tags/描述语言/" title="描述语言">描述语言<sup>1</sup></a></li>
		
			<li><a href="/tags/新特性/" title="新特性">新特性<sup>1</sup></a></li>
		
			<li><a href="/tags/struts2/" title="struts2">struts2<sup>1</sup></a></li>
		
			<li><a href="/tags/UML/" title="UML">UML<sup>1</sup></a></li>
		
			<li><a href="/tags/NoSQL/" title="NoSQL">NoSQL<sup>1</sup></a></li>
		
			<li><a href="/tags/mysql/" title="mysql">mysql<sup>1</sup></a></li>
		
			<li><a href="/tags/sql/" title="sql">sql<sup>1</sup></a></li>
		
			<li><a href="/tags/groovy/" title="groovy">groovy<sup>1</sup></a></li>
		
			<li><a href="/tags/CSS/" title="CSS">CSS<sup>1</sup></a></li>
		
			<li><a href="/tags/蓝牙/" title="蓝牙">蓝牙<sup>1</sup></a></li>
		
			<li><a href="/tags/传感器/" title="传感器">传感器<sup>1</sup></a></li>
		
			<li><a href="/tags/NFC/" title="NFC">NFC<sup>1</sup></a></li>
		
			<li><a href="/tags/多媒体/" title="多媒体">多媒体<sup>1</sup></a></li>
		
			<li><a href="/tags/定位/" title="定位">定位<sup>1</sup></a></li>
		
			<li><a href="/tags/数据持久化/" title="数据持久化">数据持久化<sup>1</sup></a></li>
		
			<li><a href="/tags/wifi网络/" title="wifi网络">wifi网络<sup>1</sup></a></li>
		
			<li><a href="/tags/语音识别/" title="语音识别">语音识别<sup>1</sup></a></li>
		
		</ul>
</div>


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/JS/" title="JS">JS<sup>2</sup></a></li>
		
			<li><a href="/categories/JVM/" title="JVM">JVM<sup>2</sup></a></li>
		
			<li><a href="/categories/JavaSE/" title="JavaSE">JavaSE<sup>3</sup></a></li>
		
			<li><a href="/categories/android/" title="android">android<sup>23</sup></a></li>
		
			<li><a href="/categories/grails/" title="grails">grails<sup>1</sup></a></li>
		
			<li><a href="/categories/linux/" title="linux">linux<sup>1</sup></a></li>
		
			<li><a href="/categories/ssh2/" title="ssh2">ssh2<sup>3</sup></a></li>
		
			<li><a href="/categories/前端/" title="前端">前端<sup>3</sup></a></li>
		
			<li><a href="/categories/前端框架/" title="前端框架">前端框架<sup>2</sup></a></li>
		
			<li><a href="/categories/后端/" title="后端">后端<sup>4</sup></a></li>
		
			<li><a href="/categories/技术/" title="技术">技术<sup>2</sup></a></li>
		
			<li><a href="/categories/技术辅助/" title="技术辅助">技术辅助<sup>3</sup></a></li>
		
			<li><a href="/categories/操作系统/" title="操作系统">操作系统<sup>1</sup></a></li>
		
			<li><a href="/categories/数据库/" title="数据库">数据库<sup>3</sup></a></li>
		
			<li><a href="/categories/框架/" title="框架">框架<sup>1</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/JDK/" style="font-size: 10px;">JDK</a> <a href="/tags/JS/" style="font-size: 11.67px;">JS</a> <a href="/tags/Java新特性/" style="font-size: 10px;">Java新特性</a> <a href="/tags/NFC/" style="font-size: 10px;">NFC</a> <a href="/tags/NoSQL/" style="font-size: 10px;">NoSQL</a> <a href="/tags/UML/" style="font-size: 10px;">UML</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/android/" style="font-size: 18.33px;">android</a> <a href="/tags/android-UI/" style="font-size: 15px;">android_UI</a> <a href="/tags/bootstrap/" style="font-size: 11.67px;">bootstrap</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/grails/" style="font-size: 10px;">grails</a> <a href="/tags/groovy/" style="font-size: 10px;">groovy</a> <a href="/tags/hibernate/" style="font-size: 11.67px;">hibernate</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/java/" style="font-size: 11.67px;">java</a> <a href="/tags/jsp/" style="font-size: 10px;">jsp</a> <a href="/tags/linux/" style="font-size: 11.67px;">linux</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/servlet/" style="font-size: 11.67px;">servlet</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/ssh/" style="font-size: 11.67px;">ssh</a> <a href="/tags/ssh2/" style="font-size: 10px;">ssh2</a> <a href="/tags/struts2/" style="font-size: 10px;">struts2</a> <a href="/tags/wifi网络/" style="font-size: 10px;">wifi网络</a> <a href="/tags/xml/" style="font-size: 10px;">xml</a> <a href="/tags/传感器/" style="font-size: 10px;">传感器</a> <a href="/tags/依赖注入/" style="font-size: 10px;">依赖注入</a> <a href="/tags/前端/" style="font-size: 16.67px;">前端</a> <a href="/tags/多媒体/" style="font-size: 10px;">多媒体</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/字节码/" style="font-size: 11.67px;">字节码</a> <a href="/tags/定位/" style="font-size: 10px;">定位</a> <a href="/tags/实例/" style="font-size: 10px;">实例</a> <a href="/tags/并发/" style="font-size: 10px;">并发</a> <a href="/tags/技术/" style="font-size: 20px;">技术</a> <a href="/tags/描述语言/" style="font-size: 10px;">描述语言</a> <a href="/tags/数据库/" style="font-size: 13.33px;">数据库</a> <a href="/tags/数据持久化/" style="font-size: 10px;">数据持久化</a> <a href="/tags/新特性/" style="font-size: 10px;">新特性</a> <a href="/tags/蓝牙/" style="font-size: 10px;">蓝牙</a> <a href="/tags/语音识别/" style="font-size: 10px;">语音识别</a> <a href="/tags/项目构建/" style="font-size: 10px;">项目构建</a>
    </div>
  </div>


  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">归档</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">25</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">八月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">一月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">十月 2012</a><span class="archive-list-count">2</span></li></ul>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.cnblogs.com/wn398/" target="_blank" title="博客园">博客园</a>
            
          </li>
        
    </ul>
</div>

  
  <div class="widget">
    <p class="asidetitle">最近访客</p>
    <div class="widget">
	  <ul class="ds-recent-visitors" id="ds-recent-visitors" data-num-items="12"></ul>
	</div>
  </div>


  
<div class="widget">
  <p class="asidetitle">最近评论</p>
    
<ul class="entry ds-recent-comments" data-num-items="8" data-show-avatars="0" data-show-time="1" data-show-admin="1" data-excerpt-length="70"></ul>
</div>


  <div>
<script type="text/javascript" src="//rj.revolvermaps.com/0/0/1.js?i=9cw5wlpmvk8&amp;m=7&amp;s=220&amp;c=e63100" async="async"></script>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" > <!--id="footer"-->
	
	<div class="line">
		<span></span>
		<div class="author" id="author"></div>
	</div>
	
	<div>
	
	<section class="info">
		<p> If you don&#39;t have never failed,you never try anything new <br/>
			       ╰︶﹉⋛⋋⊱⋋๑理想๑⋌⊰⋌⋚﹉︶╯</p>
	</section>
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/tim398" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/wn398" target="_blank" class="icon-github" title="github"></a>
		
		
		<a href="http://stackoverflow.com/users/4404127/tim" target="_blank" class="icon-stack-overflow" title="stackoverflow"></a>
		
		
		<a href="https://twitter.com/wn1698" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/100009152177427" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		<a href="https://www.linkedin.com/in/292267941" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		<a href="https://www.douban.com/people/wn398" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		<a href="https://www.zhihu.com/people/ding-ding-mu-mu" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		<a href="https://plus.google.com/108412565662276580000?rel=author" target="_blank" class="icon-google_plus" title="Google+"></a>
		
		
		<a href="mailto:164878858@qq.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
	 
	
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a>© 2016 
		
		<a href="http://wn398.github.io/about" target="_blank" title="Tim Wang">Tim Wang</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#nothing"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"wn398"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

  </body>
</html>
